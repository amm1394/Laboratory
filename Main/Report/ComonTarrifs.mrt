<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<StiSerializer version="1.02" type="Net" application="StiReport">
  <Dictionary Ref="1" type="Dictionary" isKey="true">
    <BusinessObjects isList="true" count="0" />
    <Databases isList="true" count="1">
      <DataConnection Ref="2" type="Stimulsoft.Report.Dictionary.StiSqlDatabase" isKey="true">
        <Alias>DataConnection</Alias>
        <ConnectionStringEncrypted>+fLLicIF84HHG6Ds5T11Kt5wcwvFBTHwcXv13Ho9Ii/ZcMvj3V/TgWBJTYRO2Hcb0nBlos0JQ/ViBmWlZCzrY/ZskYPNTErd4k0pxOktJXuQVNmJS11p7eIabfRhTKoXkO7R78ZMWc1iS70E6Swoe9E=</ConnectionStringEncrypted>
        <Name>DataConnection</Name>
      </DataConnection>
    </Databases>
    <DataSources isList="true" count="2">
      <Date Ref="3" type="Stimulsoft.Report.Dictionary.StiSqlSource" isKey="true">
        <Alias>Date</Alias>
        <Columns isList="true" count="1">
          <value>date,System.String</value>
        </Columns>
        <CommandTimeout>30</CommandTimeout>
        <Dictionary isRef="1" />
        <Name>Date</Name>
        <NameInSource>DataConnection</NameInSource>
        <Parameters isList="true" count="0" />
        <SqlCommand>select dbo.DateConvertor(GETDATE())date </SqlCommand>
      </Date>
      <ComonTarrifs Ref="4" type="Stimulsoft.Report.Dictionary.StiSqlSource" isKey="true">
        <Alias>ComonTarrifs</Alias>
        <Columns isList="true" count="7">
          <value>LaboratoryCode,System.Guid</value>
          <value>LaboratoryName,System.String</value>
          <value>MainCode,System.Guid</value>
          <value>MainTestName,System.String</value>
          <value>MasterTestCode,System.Guid</value>
          <value>MasterName,System.String</value>
          <value>InvoicePrice,System.Int32</value>
        </Columns>
        <CommandTimeout>30</CommandTimeout>
        <Dictionary isRef="1" />
        <Name>ComonTarrifs</Name>
        <NameInSource>DataConnection</NameInSource>
        <Parameters isList="true" count="0" />
        <SqlCommand>declare
@FINANCAILYEAR int  =(select left(dbo.DateConvertor(GETDATE()),4))


declare @tax int
declare  @Tarif_Cte as Table(MasterTestCode_Tarrif uniqueidentifier, TarrifDate datetime)


insert into @Tarif_Cte Select MasterTestCode_Tarrif,Max(TarrifDate) as TarrifDate from dbo.TARRIF where TARRIF.FinancialYear &lt;= @FINANCAILYEAR group by TARRIF.MasterTestCode_Tarrif

Select Laboratory.LaboratoryCode,Laboratory.LaboratoryName,MainTest.MainCode,MainTest.MainTestName,MasterTest.MasterTestCode,MasterTest.MasterName
	,isnull(TARRIF.InvoicePrice,0) as InvoicePrice 
	From MasterTest
	Left Join MainTest on MasterTest.MainTestCode = MainTest.MainCode
Left Join Laboratory on MainTest.LaboratoryCode_MainTest = Laboratory.LaboratoryCode
left join @Tarif_Cte on MASTERTEST.MasterTestCode = [@Tarif_Cte].MasterTestCode_Tarrif
left join TARRIF on TARRIF.TarrifDate = [@Tarif_Cte].TarrifDate and TARRIF.MasterTestCode_Tarrif = [@Tarif_Cte].MasterTestCode_Tarrif
where MASTERTEST.Status = 1 and isnull((select count(*) from DetailTest where MasterTest.MasterTestCode = DetailTest.MasterTestCode_Detail),0) &gt; 0 and Laboratory.StatusForRecieption = 1 and MasterTest.ComonTarrifs = 1
order by Laboratory.LaboratoryName,MainTest.MainTestName,MasterTest.MasterName,PriorityRec</SqlCommand>
      </ComonTarrifs>
    </DataSources>
    <Relations isList="true" count="0" />
    <Report isRef="0" />
    <Variables isList="true" count="0" />
  </Dictionary>
  <EngineVersion>EngineV2</EngineVersion>
  <GlobalizationStrings isList="true" count="0" />
  <MetaTags isList="true" count="0" />
  <Pages isList="true" count="1">
    <Page2 Ref="5" type="Page" isKey="true">
      <Border>None;Black;2;Solid;False;4;Black</Border>
      <Brush>Transparent</Brush>
      <Components isList="true" count="4">
        <PageHeaderBand1 Ref="6" type="PageHeaderBand" isKey="true">
          <Border>All;Black;1;Solid;False;4;Black</Border>
          <Brush>Transparent</Brush>
          <ClientRectangle>0,0.4,19,2.4</ClientRectangle>
          <Components isList="true" count="3">
            <Text2 Ref="7" type="Text" isKey="true">
              <Brush>Transparent</Brush>
              <ClientRectangle>0,1.4,2.8,0.8</ClientRectangle>
              <Conditions isList="true" count="0" />
              <Font>Mitra,9</Font>
              <Guid>5a727f0aba1d43f7b185cef85aa6e59b</Guid>
              <HorAlignment>Center</HorAlignment>
              <Margins>0,0,0,0</Margins>
              <Name>Text2</Name>
              <Page isRef="5" />
              <Parent isRef="6" />
              <Text>تاریخ چاپ : {Date.date}</Text>
              <TextBrush>Black</TextBrush>
              <Type>Expression</Type>
              <VertAlignment>Center</VertAlignment>
            </Text2>
            <Text1 Ref="8" type="Text" isKey="true">
              <Brush>White</Brush>
              <ClientRectangle>3.8,0.2,11.2,2</ClientRectangle>
              <Conditions isList="true" count="0" />
              <Font>Mitra,18,Bold</Font>
              <HorAlignment>Center</HorAlignment>
              <Margins>0,0,0,0</Margins>
              <Name>Text1</Name>
              <Page isRef="5" />
              <Parent isRef="6" />
              <Text>تعرفه ها</Text>
              <TextBrush>Black</TextBrush>
              <Type>Expression</Type>
            </Text1>
            <Image1 Ref="9" type="Image" isKey="true">
              <Brush>Transparent</Brush>
              <ClientRectangle>16.8,0,2.2,2.2</ClientRectangle>
              <Conditions isList="true" count="0" />
              <Guid>01bb0a42ea1e488585bece60470be52c</Guid>
              <Name>Image1</Name>
              <Page isRef="5" />
              <Parent isRef="6" />
              <Stretch>True</Stretch>
            </Image1>
          </Components>
          <Conditions isList="true" count="0" />
          <Name>PageHeaderBand1</Name>
          <Page isRef="5" />
          <Parent isRef="5" />
        </PageHeaderBand1>
        <PageFooterBand1 Ref="10" type="PageFooterBand" isKey="true">
          <Brush>Transparent</Brush>
          <ClientRectangle>0,26.9,19,0.8</ClientRectangle>
          <Components isList="true" count="1">
            <Text20 Ref="11" type="Text" isKey="true">
              <Brush>White</Brush>
              <ClientRectangle>0,0.1,5.4,0.6</ClientRectangle>
              <Conditions isList="true" count="0" />
              <Font>Mitra,11,Bold</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text20</Name>
              <Page isRef="5" />
              <Parent isRef="10" />
              <Text>{TotalPageCount} - {PageNumber} : صفحه </Text>
              <TextBrush>Black</TextBrush>
              <Type>Expression</Type>
            </Text20>
          </Components>
          <Conditions isList="true" count="0" />
          <Name>PageFooterBand1</Name>
          <Page isRef="5" />
          <Parent isRef="5" />
        </PageFooterBand1>
        <HeaderBand1 Ref="12" type="HeaderBand" isKey="true">
          <Border>All;Black;1;Solid;False;4;Black</Border>
          <Brush>Transparent</Brush>
          <ClientRectangle>0,3.6,19,0.6</ClientRectangle>
          <Components isList="true" count="4">
            <Text3 Ref="13" type="Text" isKey="true">
              <Border>All;Black;1;Solid;False;4;Black</Border>
              <Brush>Transparent</Brush>
              <ClientRectangle>18.2,0,0.8,0.6</ClientRectangle>
              <Conditions isList="true" count="0" />
              <Font>Mitra,10</Font>
              <Guid>dd1a726eaec34fe4898c55eafa0b05a7</Guid>
              <HorAlignment>Center</HorAlignment>
              <Margins>0,0,0,0</Margins>
              <Name>Text3</Name>
              <Page isRef="5" />
              <Parent isRef="12" />
              <Text>ردیف</Text>
              <TextBrush>Black</TextBrush>
              <Type>Expression</Type>
              <VertAlignment>Center</VertAlignment>
            </Text3>
            <Text4 Ref="14" type="Text" isKey="true">
              <Border>All;Black;1;Solid;False;4;Black</Border>
              <Brush>White</Brush>
              <ClientRectangle>13.6,0,4.6,0.6</ClientRectangle>
              <Conditions isList="true" count="0" />
              <Font>Mitra,10</Font>
              <HorAlignment>Center</HorAlignment>
              <Margins>0,0,0,0</Margins>
              <Name>Text4</Name>
              <Page isRef="5" />
              <Parent isRef="12" />
              <Text>آزمایشگاه</Text>
              <TextBrush>Black</TextBrush>
              <Type>Expression</Type>
              <VertAlignment>Center</VertAlignment>
            </Text4>
            <Text6 Ref="15" type="Text" isKey="true">
              <Border>All;Black;1;Solid;False;4;Black</Border>
              <Brush>White</Brush>
              <ClientRectangle>4,0,9.6,0.6</ClientRectangle>
              <Conditions isList="true" count="0" />
              <Font>Mitra,10</Font>
              <Guid>94da0466ea6f4a879994baf9e7c711ec</Guid>
              <HorAlignment>Center</HorAlignment>
              <Margins>0,0,0,0</Margins>
              <Name>Text6</Name>
              <Page isRef="5" />
              <Parent isRef="12" />
              <Text>آزمایش</Text>
              <TextBrush>Black</TextBrush>
              <Type>Expression</Type>
              <VertAlignment>Center</VertAlignment>
            </Text6>
            <Text7 Ref="16" type="Text" isKey="true">
              <Border>All;Black;1;Solid;False;4;Black</Border>
              <Brush>White</Brush>
              <ClientRectangle>0,0,4,0.6</ClientRectangle>
              <Conditions isList="true" count="0" />
              <Font>Mitra,10</Font>
              <Guid>abb62d7c656a4ef498dcf663ebbe79ec</Guid>
              <HorAlignment>Center</HorAlignment>
              <Margins>0,0,0,0</Margins>
              <Name>Text7</Name>
              <Page isRef="5" />
              <Parent isRef="12" />
              <Text>مبلغ</Text>
              <TextBrush>Black</TextBrush>
              <Type>Expression</Type>
              <VertAlignment>Center</VertAlignment>
            </Text7>
          </Components>
          <Conditions isList="true" count="0" />
          <Name>HeaderBand1</Name>
          <Page isRef="5" />
          <Parent isRef="5" />
        </HeaderBand1>
        <DataBand1 Ref="17" type="DataBand" isKey="true">
          <Border>All;Black;1;Solid;False;4;Black</Border>
          <Brush>Transparent</Brush>
          <BusinessObjectGuid isNull="true" />
          <ClientRectangle>0,5,19,0.8</ClientRectangle>
          <Components isList="true" count="4">
            <Text18 Ref="18" type="Text" isKey="true">
              <Border>All;Black;1;Solid;False;4;Black</Border>
              <Brush>Transparent</Brush>
              <ClientRectangle>18.2,0,0.8,0.8</ClientRectangle>
              <Conditions isList="true" count="0" />
              <Font>Mitra,10</Font>
              <Guid>078004f0e4f441048f82c391094f7236</Guid>
              <HorAlignment>Center</HorAlignment>
              <Margins>0,0,0,0</Margins>
              <Name>Text18</Name>
              <Page isRef="5" />
              <Parent isRef="17" />
              <Text>{Line}</Text>
              <TextBrush>Black</TextBrush>
              <Type>Expression</Type>
              <VertAlignment>Center</VertAlignment>
            </Text18>
            <Text10 Ref="19" type="Text" isKey="true">
              <Border>All;Black;1;Solid;False;4;Black</Border>
              <Brush>White</Brush>
              <ClientRectangle>13.6,0,4.6,0.8</ClientRectangle>
              <Conditions isList="true" count="0" />
              <Font>Mitra,10</Font>
              <HorAlignment>Center</HorAlignment>
              <Margins>0,0,0,0</Margins>
              <Name>Text10</Name>
              <Page isRef="5" />
              <Parent isRef="17" />
              <Text>{ComonTarrifs.LaboratoryName}</Text>
              <TextBrush>Black</TextBrush>
              <Type>Expression</Type>
              <VertAlignment>Center</VertAlignment>
            </Text10>
            <Text11 Ref="20" type="Text" isKey="true">
              <Border>All;Black;1;Solid;False;4;Black</Border>
              <Brush>White</Brush>
              <ClientRectangle>4,0,9.6,0.8</ClientRectangle>
              <Conditions isList="true" count="0" />
              <Font>Mitra,10</Font>
              <Guid>4c2a93c455c1452cb9be3c231547d375</Guid>
              <HorAlignment>Center</HorAlignment>
              <Margins>0,0,0,0</Margins>
              <Name>Text11</Name>
              <Page isRef="5" />
              <Parent isRef="17" />
              <Text>{ComonTarrifs.MasterName}</Text>
              <TextBrush>Black</TextBrush>
              <TextFormat Ref="21" type="NumberFormat" isKey="true">
                <DecimalDigits>0</DecimalDigits>
                <GroupSeparator>,</GroupSeparator>
                <NegativePattern>1</NegativePattern>
                <UseLocalSetting>False</UseLocalSetting>
              </TextFormat>
              <Type>Expression</Type>
              <VertAlignment>Center</VertAlignment>
            </Text11>
            <Text12 Ref="22" type="Text" isKey="true">
              <Border>All;Black;1;Solid;False;4;Black</Border>
              <Brush>White</Brush>
              <ClientRectangle>0,0,4,0.8</ClientRectangle>
              <Conditions isList="true" count="0" />
              <Font>Mitra,10</Font>
              <Guid>4d89b0e2e38e47f8994d623eb909cf63</Guid>
              <HorAlignment>Center</HorAlignment>
              <Margins>0,0,0,0</Margins>
              <Name>Text12</Name>
              <Page isRef="5" />
              <Parent isRef="17" />
              <Text>{ComonTarrifs.InvoicePrice}</Text>
              <TextBrush>Black</TextBrush>
              <TextFormat Ref="23" type="NumberFormat" isKey="true">
                <DecimalDigits>0</DecimalDigits>
                <GroupSeparator>,</GroupSeparator>
                <NegativePattern>1</NegativePattern>
                <UseLocalSetting>False</UseLocalSetting>
              </TextFormat>
              <Type>Expression</Type>
              <VertAlignment>Center</VertAlignment>
            </Text12>
          </Components>
          <Conditions isList="true" count="0" />
          <DataRelationName isNull="true" />
          <DataSourceName>ComonTarrifs</DataSourceName>
          <Filters isList="true" count="0" />
          <Name>DataBand1</Name>
          <Page isRef="5" />
          <Parent isRef="5" />
          <Sort isList="true" count="0" />
        </DataBand1>
      </Components>
      <Conditions isList="true" count="0" />
      <Guid>e964dff1fa8d41e0a31d1506f8a201ff</Guid>
      <Margins>1,1,1,1</Margins>
      <Name>Page2</Name>
      <PageHeight>29.7</PageHeight>
      <PageWidth>21</PageWidth>
      <PaperSize>A4</PaperSize>
      <Report isRef="0" />
      <Watermark Ref="24" type="Stimulsoft.Report.Components.StiWatermark" isKey="true">
        <Font>Arial,100</Font>
        <TextBrush>[50:0:0:0]</TextBrush>
      </Watermark>
    </Page2>
  </Pages>
  <PrinterSettings Ref="25" type="Stimulsoft.Report.Print.StiPrinterSettings" isKey="true" />
  <ReferencedAssemblies isList="true" count="8">
    <value>System.Dll</value>
    <value>System.Drawing.Dll</value>
    <value>System.Windows.Forms.Dll</value>
    <value>System.Data.Dll</value>
    <value>System.Xml.Dll</value>
    <value>Stimulsoft.Controls.Dll</value>
    <value>Stimulsoft.Base.Dll</value>
    <value>Stimulsoft.Report.Dll</value>
  </ReferencedAssemblies>
  <ReportAlias>Report</ReportAlias>
  <ReportChanged>11/23/2023 7:40:22 AM</ReportChanged>
  <ReportCreated>4/5/2014 4:12:20 PM</ReportCreated>
  <ReportFile>C:\Source\Laboratory\Laboratory\Main\Report\ComonTarrifs.mrt</ReportFile>
  <ReportGuid>606ce6113898494487aad1e3cac5765d</ReportGuid>
  <ReportName>Report</ReportName>
  <ReportUnit>Centimeters</ReportUnit>
  <ReportVersion>2013.2.1612</ReportVersion>
  <Script>using System;
using System.Drawing;
using System.Windows.Forms;
using System.Data;
using Stimulsoft.Controls;
using Stimulsoft.Base.Drawing;
using Stimulsoft.Report;
using Stimulsoft.Report.Dialogs;
using Stimulsoft.Report.Components;

namespace Reports
{
    public class Report : Stimulsoft.Report.StiReport
    {
        public Report()        {
            this.InitializeComponent();
        }

        #region StiReport Designer generated code - do not modify
		#endregion StiReport Designer generated code - do not modify
    }
}
</Script>
  <ScriptLanguage>CSharp</ScriptLanguage>
  <Styles isList="true" count="0" />
</StiSerializer>